Взаимодействие с SQL Server


Способы взаимодействия 
	Присоединенный - на каждое действие отсылается запрос к бд
	Отсоединенный - БД буферизируется в коллекциях приложения
	изменения вносятся специальными командами обычно в момент закрытия приложения

Для установки подключения используется строка подключения


Data Source=(LocalDB)\MSSQLLocalDB;AttachDbFilename=C:\Users\luche\source\repos\C#\DB\DB\Database1.mdf;Integrated Security=True

System.Data.SqlClient

 command.ExecuteScalar();
 command.ExecuteNonQuery();
 command.ExecuteReader();
                
ORM - object relation mapping - отображение данных на обьекты
создание обьектов с такой же структурой как и у таблицы БД

Конфигурация БД
Строка подключения исключительно индивидуальное значение зависит от пк


SQL injections

SQL иньекции - разновидность атак когда вместо данных попадают команды (sql запросы)

Что будет если в строку ID записать
ID = "1';DROP TABLE Manager WHERE '' = '"
получится запрос и исполнится СУБД

Пути решения:
1 Проверка данных на запрешенные символы
2 Экранирование добавление слешей или других символов к спецсимволам
3 Разделение кода и данных, введение параметров

Подготовленные Prepared запросы
Главное что позволяют подготовленные запросы - разделить код и данные

Запрос выполняется в 2 этапа:
компиляция 
выполнение

На этапе подготовки запрос содержит текст инструкции в котором вместо данных используются параметры или плейсхолдеры

SELECT * FROM Managers M WHERE M.id = @mid параметр
SELECT * FROM Managers M WHERE M.id = ? плейсхолдер


Далее запрос должен быть выполнен с установленными параметрами
Есть несколько способов установки параметров:
 передать их как массив значений 
 установить каждый отдельно указав тип данных
 связать с переменной значения будут братся из переменной в момент запроса



Контекст
Контекст - "окружение" контейнер обслуживающий данные


Системные таблицы

